# 総合カスタム処理.gs 機能説明書

## 📋 概要

`総合カスタム処理.gs` は、Google Sheets上で不動産物件の検針データ管理を自動化するための統合Google Apps Scriptです。複数の個別機能を一つのファイルに統合し、使いやすいカスタムメニューインターフェースを提供します。

## 🎯 主要機能

### 1. データ連携機能
- **マスタデータから検針データの自動生成**
- **新規物件・部屋の自動反映**
- **データ整合性の維持**

### 2. データフォーマット機能
- **物件IDの標準化（P + 6桁数字形式）**
- **一括フォーマット変換**

### 3. データ整合性チェック機能
- **孤立データの検出と削除**
- **マスタデータとの同期チェック**

### 4. 月次データ処理機能
- **検針データの月次アーカイブ**
- **データのリセットと次月準備**

---

## 🚀 セットアップ方法

### 前提条件
- Google Sheets スプレッドシート
- 以下のシートが存在する必要があります：
  - `物件マスタ` (列: 物件ID, 物件名)
  - `部屋マスタ` (列: 物件ID, 部屋ID, 部屋名)
  - `inspection_data` (自動作成されます)

### インストール手順
1. Google Sheetsを開く
2. 「拡張機能」→「Apps Script」をクリック
3. デフォルトコードを削除し、`総合カスタム処理.gs`の内容を貼り付け
4. 保存（Ctrl+S）
5. スプレッドシートに戻り、ページを再読み込み（F5）
6. メニューバーに「総合カスタム処理」が表示される

---

## 📖 機能詳細

### 🔧 ユーティリティ関数

#### `safeAlert(title, message)`
**目的**: UI操作を安全に処理し、エラー時にログ出力にフォールバック
**使用場面**: すべての関数でユーザー通知に使用

---

### 1️⃣ データ連携機能

#### `populateInspectionDataFromMasters()`
**目的**: 物件マスタと部屋マスタから検針データシートに新規データを追加

**処理フロー**:
1. 物件マスタから物件ID→物件名のマップを作成
2. inspection_dataの既存データを読み込み（重複チェック用）
3. 部屋マスタから新規部屋データを取得
4. 既存にない部屋のみを新規追加

**追加されるデータ**:
- 記録ID (UUID)
- 物件名（物件マスタから取得）
- 物件ID
- 部屋ID  
- 部屋名
- その他の列は空白で初期化

**メニュー位置**: `2. マスタから検針データへ新規部屋反映`

---

### 2️⃣ 初期データ作成機能

#### `createInitialInspectionData()`
**目的**: inspection_dataシートの初期作成と初期データ生成

**自動シート作成機能**:
```javascript
if (!inspectionDataSheet) {
  inspectionDataSheet = ss.insertSheet(INSPECTION_DATA_SHEET_NAME);
  Logger.log(`"${INSPECTION_DATA_SHEET_NAME}" シートを新規作成しました。`);
}
```

**ヘッダー構成**:
```javascript
const INSPECTION_DATA_HEADERS = [
  '記録ID', '物件名', '物件ID', '部屋ID', '部屋名',
  '検針日時', '警告フラグ', '写真URL', '標準偏差値',
  '今回使用量', '今回の指示数', '前回指示数', '前々回指示数'
];
```

**処理内容**:
1. inspection_dataシートの存在確認（なければ自動作成）
2. ヘッダー行の設定
3. 既存部屋IDの重複チェック
4. 部屋マスタから新規部屋データの初期登録

**メニュー位置**: `1. 初期検針データ作成 (部屋マスタから)`

---

### 3️⃣ 物件IDフォーマット機能

#### `formatPropertyIdsInPropertyMaster()`
**目的**: 物件マスタシートの物件IDを標準形式（P + 6桁数字）に統一

**フォーマット例**:
- `1` → `P000001`
- `P1` → `P000001`  
- `123` → `P000123`
- `P000123` → `P000123` (変更なし)

**処理対象**:
- 純粋な数値
- `P`で始まる数値
- 既に正しい形式のものは変更なし

**メニュー位置**: `3. 物件マスタの物件IDフォーマット`

#### `formatPropertyIdsInRoomMaster()`
**目的**: 部屋マスタシートの物件IDを標準形式に統一

**処理内容**: 物件マスタと同様のフォーマット処理を部屋マスタに適用

**メニュー位置**: `4. 部屋マスタの物件IDフォーマット`

---

### 4️⃣ データ整合性チェック機能

#### `cleanUpOrphanedRooms()`
**目的**: 部屋マスタで物件マスタに存在しない物件IDを参照している行を削除

**処理フロー**:
1. 物件マスタから有効な物件IDのセットを作成
2. 部屋マスタの各行の物件IDをチェック
3. 物件マスタに存在しない物件IDの行を削除（後ろから処理）

**削除例**:
- 物件マスタに`P000001`, `P000002`が存在
- 部屋マスタに`P000003`を参照する行がある場合、その行を削除

**メニュー位置**: `5. 部屋マスタの孤立データ削除 (整合性チェック)`

---

### 5️⃣ 月次データ処理機能

#### `processInspectionDataMonthly()`
**目的**: 月次の検針データアーカイブとデータリセット

**アーカイブ処理**:
1. 現在の年月から新しいシート名を生成（例：`2024年03月`）
2. 既存同名シートの確認と上書き確認
3. 指定列のデータをアーカイブシートにコピー

**コピー対象列**:
```javascript
const columnsToCopy = [
  "記録ID", "物件名", "物件ID", "部屋ID", "部屋名",
  "検針日時", "今回使用量", "今回の指示数", "前回指示数", "写真URL"
];
```

**データリセット処理**:
- 前々々回指示数 ← 前々回指示数
- 前々回指示数 ← 前回指示数  
- 前回指示数 ← 今回の指示数
- 今回の指示数 ← 空白
- 写真URL ← 空白

**自動フィルター設定**: アーカイブシートに自動的にフィルターを適用

**メニュー位置**: `6. 月次検針データ保存とリセット`

---

## 📱 メニューシステム

### `onOpen()`
**目的**: スプレッドシートが開かれた時に自動実行され、カスタムメニューを作成

**メニュー構成**:
```
総合カスタム処理
├── 1. 初期検針データ作成 (部屋マスタから)
├── 2. マスタから検針データへ新規部屋反映
├── ───────────────────
├── 3. 物件マスタの物件IDフォーマット
├── 4. 部屋マスタの物件IDフォーマット
├── ───────────────────
├── 5. 部屋マスタの孤立データ削除 (整合性チェック)
├── ───────────────────
└── 6. 月次検針データ保存とリセット
```

---

## 🎮 各メニューの詳細動作機能

### 📋 **メニュー1: 初期検針データ作成 (部屋マスタから)**
**何をするメニューか**: 検針作業で使う基本データを自動で作成してくれる

#### 🏠 **このメニューが行うこと**
1. **準備確認**
   - 「物件マスタ」と「部屋マスタ」のシートがあるかチェック
   - どちらかが無い場合は、エラーメッセージでお知らせ

2. **検針データシートの自動作成**
   - 「inspection_data」という名前のシートを自動で作成
   - 既にある場合は、そのまま使用

3. **必要な項目を準備**
   - 検針に必要な13個の項目（記録ID、物件名、物件ID、部屋ID、部屋名、検針日時、警告フラグ、写真URL、標準偏差値、今回使用量、今回の指示数、前回指示数、前々回指示数）を自動設定
   - 既に項目がある場合は、そのまま残す

4. **重複防止**
   - 同じ部屋のデータが重複して作られないよう自動でチェック

5. **物件と部屋の情報を結合**
   - 物件マスタから物件名を取得
   - 部屋マスタから部屋情報を取得
   - 自動的に組み合わせて検針データを作成

6. **データの一括作成**
   - すべての部屋に対して検針用のデータを一度に作成
   - 作成した件数をメッセージでお知らせ

#### 💡 **こんな時に使います**
- 🆕 **初めて検針システムを使い始める時**
- 🔄 **検針データをゼロから作り直したい時**
- 📊 **物件・部屋の情報から検針データを新しく生成したい時**

#### 📝 **使用例**
例：アパート3棟、計30部屋の検針データを初めて作る場合
→ このメニューを1回実行するだけで、30部屋分の検針データが自動で作成される

---

### 📊 **メニュー2: マスタから検針データへ新規部屋反映**
**何をするメニューか**: 新しく追加した物件や部屋を検針データに自動で追加してくれる

#### 🏢 **このメニューが行うこと**
1. **必要なシートの確認**
   - 「物件マスタ」「部屋マスタ」「inspection_data」の3つのシートがあるかチェック
   - どれか1つでも無い場合は、エラーメッセージでお知らせ

2. **物件情報の読み込み**
   - 物件マスタから物件IDと物件名の一覧を取得
   - 物件IDから物件名を自動で探せるように準備

3. **重複防止のチェック**
   - 既にある検針データを確認
   - 同じ物件ID+部屋IDの組み合わせが重複しないようチェック

4. **新しい部屋の発見**
   - 部屋マスタにある部屋の中から、まだ検針データに無い部屋を探す
   - 物件IDや部屋IDが空白の行は自動でスキップ

5. **新規データの作成**
   - 見つかった新しい部屋について、検針用のデータを作成
   - 物件名は物件マスタから自動で取得
   - 物件名が見つからない場合は「物件名不明(ID番号)」と表示

6. **一括での追加**
   - 新しい部屋のデータをまとめて検針データに追加
   - 追加した件数をメッセージでお知らせ

#### 💡 **こんな時に使います**
- 🏢 **新しい物件を管理対象に追加した後**
- 🚪 **既存の物件に新しい部屋を追加した後**  
- 🔄 **定期的にデータの同期を取りたい時**
- ✅ **データに漏れがないか確認したい時**

#### 📝 **使用例**
例：新しいマンション（10部屋）を物件マスタと部屋マスタに登録した後
→ このメニューを実行すると、10部屋分の検針データが自動で追加される

---

### 🔧 **メニュー3: 物件マスタの物件IDフォーマット**
**何をするメニューか**: 物件IDを統一された見やすい形式に自動で整理してくれる

#### 🏷️ **このメニューが行うこと**
1. **物件マスタシートの確認**
   - 「物件マスタ」シートがあるかチェック
   - 無い場合は、エラーメッセージでお知らせ

2. **データの読み込み**
   - 物件マスタのタイトル行（1行目）をスキップ
   - 物件IDが入っているA列のデータを対象として処理

3. **形式の統一**
   - バラバラな物件IDを「P000001」のような統一された形式に変換
   - 例：
     - `1` → `P000001`
     - `P1` → `P000001`  
     - `123` → `P000123`
     - `P000123` → そのまま（既に正しい形式）

4. **対象データの判定**
   - 数字だけのもの（例：1, 123）
   - Pで始まって数字が続くもの（例：P1, P123）
   - 既に正しい形式のものは変更しない

5. **一括での更新**
   - 変更が必要なデータのみを自動で更新
   - 更新した件数をメッセージでお知らせ

#### 💡 **こんな時に使います**
- 📥 **外部からデータを取り込んだ後**（ExcelファイルやCSVファイルなど）
- 🔄 **データの見た目を統一したい時**
- 🏷️ **物件IDの形式をきれいに揃えたい時**

#### 📝 **使用例**
例：物件IDが「1」「P2」「123」「P000004」とバラバラに入力されている場合
→ このメニューを実行すると「P000001」「P000002」「P000123」「P000004」に統一される

---

### 🔧 **メニュー4: 部屋マスタの物件IDフォーマット**
**何をするメニューか**: 部屋マスタの物件IDも統一された見やすい形式に自動で整理してくれる

#### 🏠 **このメニューが行うこと**
1. **部屋マスタシートの確認**
   - 「部屋マスタ」シートがあるかチェック

2. **既に正しい形式かチェック**
   - 「P000001」のような正しい形式の物件IDは変更しない
   - 変更が必要なもののみを対象とする

3. **形式の統一**
   - メニュー3と同じように、物件IDを「P000001」形式に変換
   - 数字部分を6桁に揃えて、前に「P」を付ける

4. **データの整理**
   - 「P」で始まる場合は、その後ろの数字部分を取得
   - 純粋な数字の場合は、そのまま使用
   - 数字以外が含まれている場合はスキップ

5. **一括更新**
   - 変更されたデータをまとめてシートに反映
   - 更新した件数をお知らせ

#### 💡 **こんな時に使います**
- 🏠 **部屋マスタのデータを整理したい時**
- 🔗 **物件マスタとの形式を合わせたい時**
- 📊 **他のシステムとの連携準備をする時**

#### 📝 **使用例**
例：部屋マスタの物件IDが「1」「P2」「123」となっている場合
→ このメニューを実行すると「P000001」「P000002」「P000123」に統一される

---

### 🧹 **メニュー5: 部屋マスタの孤立データ削除 (整合性チェック)**
**何をするメニューか**: 存在しない物件を参照している部屋のデータを自動で見つけて削除してくれる

#### 🔍 **このメニューが行うこと**
1. **必要なシートの確認**
   - 「部屋マスタ」と「物件マスタ」の両方があるかチェック

2. **有効な物件IDリストの作成**
   - 物件マスタに実際に登録されている物件IDを全て収集
   - 空白や無効なデータは除外

3. **問題のある部屋データの発見**
   - 部屋マスタの各行をチェック
   - 物件マスタに存在しない物件IDを参照している部屋を特定

4. **安全な削除処理**
   - 問題のある行を後ろから順番に削除
   - （前から削除すると行番号がずれて問題が起きるため）

5. **結果の報告**
   - 削除した行数をカウントしてお知らせ
   - どの行を削除したかも記録

#### 💡 **こんな時に使います**
- 🧹 **データの定期的なお掃除をしたい時**
- 🔍 **データに矛盾がないか確認したい時**
- 🏢 **物件を削除した後のクリーンアップ**
- 📊 **データの品質を向上させたい時**

#### 📝 **使用例**
例：物件マスタには「P000001」「P000002」しか無いのに、部屋マスタに「P000003」を参照する部屋がある場合
→ このメニューを実行すると、「P000003」を参照している部屋のデータが自動で削除される

#### ⚠️ **注意事項**
- 削除されたデータは元に戻せないので、事前にバックアップを取ることをお勧めします
- 物件を削除する前に、その物件に関連する部屋データがあるかを確認してから実行してください

---

### 📅 **メニュー6: 月次検針データ保存とリセット**
**何をするメニューか**: 今月の検針結果を保存して、来月の検針準備を自動で行ってくれる

#### 📊 **このメニューが行うこと**
1. **検針データシートの確認**
   - 「inspection_data」シートがあるかチェック

2. **今月のアーカイブシート作成**
   - 今日の日付から「2025年06月」のような名前のシートを自動作成
   - 既に同じ名前のシートがある場合は、上書きするか確認メッセージを表示

3. **必要なデータのコピー**
   - 検針に関係する重要な項目だけを新しいシートにコピー：
     - 記録ID、物件名、物件ID、部屋ID、部屋名
     - 検針日時、今回使用量、今回の指示数、前回指示数、写真URL
   - 全てのデータが新しいシートに保存される

4. **検索機能の追加**
   - コピーしたデータに自動でフィルター機能を設定
   - 後から特定の物件や部屋を簡単に検索できるようになる

5. **来月の準備（データのリセット）**
   - **指示数の履歴を1つずつ後ろにずらす**：
     - 前々々回指示数 ← 前々回指示数の値
     - 前々回指示数 ← 前回指示数の値
     - 前回指示数 ← 今回の指示数の値
     - 今回の指示数 ← 空白にする
   - **写真URLも空白にリセット**
   - これで来月の検針作業の準備が完了

#### 💡 **こんな時に使います**
- 📅 **月末の定期処理として**
- 💾 **検針データの長期保存のため**
- 🔄 **来月の検針作業の準備のため**
- 📊 **過去のデータを後から見返したい時のため**

#### 📝 **使用例**
例：6月の検針が終わった時にこのメニューを実行すると：
1. 「2025年06月」という名前のシートが作成される
2. 6月の検針結果が全て保存される
3. inspection_dataシートは7月の検針用に自動でリセットされる
4. 過去の指示数は履歴として残り、今回の指示数は空白になる

#### 🔄 **指示数の履歴について**
検針では過去の数値と比較することが重要なので、このメニューでは：
- **今回入力した数値** → **前回の数値**として保存
- **前回の数値** → **前々回の数値**として保存
- **前々回の数値** → **前々々回の数値**として保存
- **今回の入力欄** → 空白にして、新しい入力を待つ

このように自動で履歴を管理してくれます。

### 診断・セットアップ支援機能

#### 🛠️ **トラブル解決用の機能**
もしメニューが表示されない場合や、エラーが発生した場合に使用できる診断機能も用意されています：

- **`setupMenuTrigger()`**: メニューが表示されない時の解決方法を案内
- **`checkSpreadsheetInfo()`**: スプレッドシートとスクリプトの接続状態を確認  
- **`diagnoseAndSetup()`**: 環境全体の診断と修復手順を表示

これらの機能は、問題が発生した時にサポート担当者が使用する専門的な機能です。

---

## 🎯 メニュー実行時の基本的な流れ

### ✅ **正常に動作する時**
1. **処理開始**: メニューをクリックすると処理が始まります
2. **進行状況**: 処理中の詳細は背景で記録されます
3. **完了通知**: 処理が終わると結果をメッセージでお知らせします
4. **結果確認**: 何件のデータを処理したかなどが表示されます

### ❌ **エラーが発生した時**
1. **エラー検出**: 問題があると自動で検出されます
2. **安全停止**: データが壊れないよう、適切な場所で処理を停止します
3. **エラー通知**: 何が問題だったかを分かりやすくお知らせします
4. **記録保存**: 後で確認できるよう、詳細な記録を保存します

### 🔍 **事前チェック機能**
すべてのメニューには以下のような安全機能が組み込まれています：
- **必要なシートがあるかチェック**
- **データの形式が正しいかチェック**  
- **重複するデータがないかチェック**
- **関連するデータとの整合性チェック**

---

## 🔍 トラブルシューティング

### よくある問題と解決方法

#### 1. メニューが表示されない
**原因**: スクリプトがスプレッドシートに関連付けられていない
**解決方法**:
1. スプレッドシートから「拡張機能」→「Apps Script」でスクリプトエディタを開く
2. スクリプトを保存
3. スプレッドシートを再読み込み（F5）

#### 2. 「SyntaxError: Identifier has already been declared」
**原因**: 重複する変数宣言
**解決方法**: 統合ファイルでは重複宣言を削除済み（既に修正済み）

#### 3. シートが見つかりません
**原因**: 必要なシートが存在しない
**解決方法**:
- `物件マスタ`シートを作成（列: 物件ID, 物件名）
- `部屋マスタ`シートを作成（列: 物件ID, 部屋ID, 部屋名）
- `inspection_data`は自動作成されます

#### 4. UI操作エラー
**原因**: スタンドアロンスクリプトでUI操作を試行
**解決方法**: スプレッドシート関連付けスクリプトとして実行

---

## 🛡️ エラーハンドリング

### 安全機能
- **Try-catch文**: すべての主要関数で例外処理を実装
- **存在チェック**: シートやデータの存在を事前確認
- **ログ出力**: 詳細な処理ログとエラー情報を記録
- **ユーザー通知**: 処理結果を分かりやすく通知

### ログレベル
- **📋 情報**: 一般的な処理状況
- **✅ 成功**: 正常完了
- **❌ エラー**: エラー発生
- **⚠️ 警告**: 注意が必要な状況
- **💡 ヒント**: 解決方法の提案

---

## 📊 データ形式仕様

### 物件マスタシート
| 列 | 項目名 | データ型 | 例 |
|---|---|---|---|
| A | 物件ID | 文字列 | P000001 |
| B | 物件名 | 文字列 | 〇〇マンション |

### 部屋マスタシート  
| 列 | 項目名 | データ型 | 例 |
|---|---|---|---|
| A | 物件ID | 文字列 | P000001 |
| B | 部屋ID | 文字列 | 101 |
| C | 部屋名 | 文字列 | 1階1号室 |

### inspection_dataシート
| 列 | 項目名 | データ型 | 自動設定 |
|---|---|---|---|
| A | 記録ID | 文字列 | ✅ UUID |
| B | 物件名 | 文字列 | ✅ マスタから |
| C | 物件ID | 文字列 | ✅ マスタから |
| D | 部屋ID | 文字列 | ✅ マスタから |
| E | 部屋名 | 文字列 | ✅ マスタから |
| F | 検針日時 | 日時 | 手動入力 |
| G | 警告フラグ | 文字列 | 手動入力 |
| H | 写真URL | 文字列 | 手動入力 |
| I | 標準偏差値 | 数値 | 手動入力 |
| J | 今回使用量 | 数値 | 手動入力 |
| K | 今回の指示数 | 数値 | 手動入力 |
| L | 前回指示数 | 数値 | 月次処理で自動更新 |
| M | 前々回指示数 | 数値 | 月次処理で自動更新 |

---

## 🔄 使い方の順序（初めての方向け）

### 🚀 **初めてシステムを使う時の手順**
```
1. 物件マスタの準備
   ↓ 管理したい物件の情報（物件ID、物件名）を入力

2. 部屋マスタの準備  
   ↓ 各物件の部屋情報（物件ID、部屋ID、部屋名）を入力

3. メニュー3を実行「物件マスタの物件IDフォーマット」
   ↓ 物件IDを「P000001」のような統一された形式に整理

4. メニュー4を実行「部屋マスタの物件IDフォーマット」
   ↓ 部屋マスタの物件IDも同じ形式に統一

5. メニュー1を実行「初期検針データ作成」
   ↓ 検針用のデータシートを自動作成＋基本データを準備

6. 完了：検針作業を開始できます
```

### 📅 **毎月の作業手順**
```
【新しい物件を追加した時】
1. 物件マスタに新しい物件を追加
   ↓
2. 部屋マスタに新しい部屋を追加
   ↓  
3. メニュー3,4を実行：物件IDの形式を統一
   ↓
4. メニュー2を実行「新規部屋反映」
   ↓
5. 完了：新しい物件の検針ができるようになります

【月末の処理】
1. その月の検針データを確認
   ↓
2. メニュー6を実行「月次検針データ保存とリセット」
   ↓
3. 今月のデータが保存され、来月の準備が完了
   ↓
4. 完了：来月の検針作業を開始できます

【定期的なお手入れ】
1. メニュー5を実行「孤立データ削除」
   ↓
2. データの整合性をチェック・修正
   ↓
3. 必要に応じて物件・部屋マスタを修正
```

### 🎯 **どのメニューを使えばいいか迷った時**

#### 🆕 **初めて使う時**
→ **メニュー1「初期検針データ作成」**を使ってください

#### 🏢 **新しい物件・部屋を追加した時**
→ **メニュー2「新規部屋反映」**を使ってください

#### 🏷️ **物件IDの見た目がバラバラな時**
→ **メニュー3,4「物件IDフォーマット」**を使ってください

#### 🧹 **データを整理したい時**
→ **メニュー5「孤立データ削除」**を使ってください

#### 📅 **月が変わった時**
→ **メニュー6「月次保存とリセット」**を使ってください

### ⚡ **困った時の対処法**
```
【メニューが表示されない時】
1. ページを更新する（F5キー）
   ↓
2. 別のブラウザで試してみる
   ↓
3. システム管理者に相談

【エラーメッセージが出た時】
1. エラーメッセージの内容を記録
   ↓
2. 同じ操作をもう一度試してみる
   ↓
3. それでも解決しない場合は管理者に相談

【データが消えてしまった時】
1. あわてずに、まずは状況を確認
   ↓
2. 月次保存で作られたアーカイブシートを確認
   ↓
3. Google Sheetsの「編集履歴」から復元を試す
   ↓
4. 管理者と一緒に復旧作業
```

---

## 🔐 セキュリティとベストプラクティス

### データ保護
- **バックアップ**: 月次アーカイブで自動バックアップ
- **アクセス制御**: Google Sheetsの共有設定で制御
- **変更履歴**: Google Sheetsの版履歴機能を活用

### 運用推奨事項
- **定期的な整合性チェック**: 月1回程度実行
- **ログ確認**: エラー発生時はログを確認
- **段階的実行**: 大量データ処理前にテスト実行

---

## 📝 更新履歴

### バージョン 1.0
- 初回統合版リリース
- 6つの個別機能を統合
- 自動シート作成機能追加
- 包括的エラーハンドリング実装

### 修正済み問題
- ✅ 変数重複宣言エラーの解決
- ✅ inspection_dataシート自動作成の実装
- ✅ ローカル変数スコープの最適化

---

## 🤝 サポート

### 問題報告
問題が発生した場合は以下の情報を記録してください：
- エラーメッセージ
- 実行していた機能
- スプレッドシートの構成
- ログ出力（Apps Scriptエディタの「実行」→「実行履歴」で確認）

### 機能拡張
新しい機能が必要な場合は、既存の機能構造を参考に追加開発が可能です。

---

*このドキュメントは `総合カスタム処理.gs` (769行) の機能を包括的に説明しています。*
*最終更新: 2024年03月*
