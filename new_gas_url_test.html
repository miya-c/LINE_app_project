<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ æ–°ã—ã„GAS URL ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #fafafa;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .error {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }
        .info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #17a2b8;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin: 10px 0;
            font-size: 12px;
        }
        input, select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px;
            width: 200px;
        }
        code {
            background: #f1f1f1;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .url-display {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ–°ã—ã„GAS Web App URL ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-section">
            <h3>ğŸ“‹ ç¾åœ¨ã®URLè¨­å®š</h3>
            <div class="url-display" id="currentUrl"></div>
            <div class="info">
                âœ… <strong>ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆçµæœ:</strong> GAS Web App ã¯æ­£å¸¸ã«å‹•ä½œä¸­<br>
                âŒ <strong>ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆçµæœ:</strong> CORS ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª æ®µéšçš„ãƒ†ã‚¹ãƒˆ</h3>
            
            <h4>Step 1: åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆ</h4>
            <button class="btn" onclick="testBasicConnection()">åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
            <button class="btn" onclick="testWithSimpleHeaders()">ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ</button>
            
            <h4>Step 2: èªè¨¼ãƒ†ã‚¹ãƒˆ</h4>
            <div style="margin: 10px 0;">
                <input type="text" id="username" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å" value="test_user">
                <input type="password" id="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" value="test_password">
                <button class="btn" onclick="testAuthentication()">èªè¨¼ãƒ†ã‚¹ãƒˆ</button>
            </div>
            
            <h4>Step 3: ãƒ•ã‚§ãƒƒãƒã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¯”è¼ƒ</h4>
            <button class="btn" onclick="testMinimalFetch()">æœ€å°ãƒ•ã‚§ãƒƒãƒ</button>
            <button class="btn" onclick="testStandardFetch()">æ¨™æº–ãƒ•ã‚§ãƒƒãƒ</button>
            <button class="btn" onclick="testCorsWorkaround()">CORSå›é¿ãƒ•ã‚§ãƒƒãƒ</button>
        </div>

        <div class="test-section">
            <h3>ğŸ” CORSè¨ºæ–­</h3>
            <button class="btn" onclick="checkCorsHeaders()">CORSãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª</button>
            <button class="btn" onclick="testPreflight()">Preflightãƒ†ã‚¹ãƒˆ</button>
            <button class="btn" onclick="testDifferentMethods()">ãƒ¡ã‚½ãƒƒãƒ‰æ¯”è¼ƒãƒ†ã‚¹ãƒˆ</button>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š çµæœ</h3>
            <div id="results"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“ è©³ç´°ãƒ­ã‚°</h3>
            <button class="btn" onclick="clearLog()">ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
            <div class="log" id="log"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ’¡ æ¨å¥¨è§£æ±ºç­–</h3>
            <div class="info">
                <strong>CORSå•é¡Œã®è§£æ±ºæ–¹æ³•:</strong><br>
                1. <strong>GAS Web App ã®å†ãƒ‡ãƒ—ãƒ­ã‚¤</strong>ï¼ˆå®Œäº†æ¸ˆã¿ âœ…ï¼‰<br>
                2. <strong>ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèª</strong><br>
                3. <strong>ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§ã®ã‚¢ã‚¯ã‚»ã‚¹</strong><br>
                4. <strong>Vercel/Netlify ç­‰ã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤</strong>ï¼ˆCORSåˆ¶é™ãªã—ï¼‰
            </div>
        </div>
    </div>

    <script>
        const NEW_GAS_URL = 'https://script.google.com/macros/s/AKfycbxcHx_JLTQK9IqwwkKf23cVK5XHHKxMzQ5yJDMQy8Lshr_SM52uN9K39PLpaQDyc7VeRQ/exec';
        
        // URLè¡¨ç¤º
        document.getElementById('currentUrl').textContent = NEW_GAS_URL;

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('ja-JP');
            const logElement = document.getElementById('log');
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : 'â„¹ï¸';
            logElement.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`[${type}] ${message}`);
        }

        function clearLog() {
            document.getElementById('log').textContent = '';
            document.getElementById('results').innerHTML = '';
        }

        function showResult(type, title, message) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `<strong>${title}</strong><br>${message}`;
            results.appendChild(div);
        }

        // Test 1: åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆ
        async function testBasicConnection() {
            log('=== åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            try {
                const testUrl = `${NEW_GAS_URL}?action=test&timestamp=${Date.now()}`;
                log(`ãƒ†ã‚¹ãƒˆURL: ${testUrl}`);
                
                const response = await fetch(testUrl);
                
                log(`ãƒ¬ã‚¹ãƒãƒ³ã‚¹çŠ¶æ³: ${response.status} ${response.statusText}`, 'info');
                log(`ãƒ¬ã‚¹ãƒãƒ³ã‚¹URL: ${response.url}`, 'info');
                log(`ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼: ${JSON.stringify([...response.headers.entries()])}`, 'info');
                
                if (response.ok) {
                    const result = await response.json();
                    log(`æ¥ç¶šæˆåŠŸ: ${JSON.stringify(result, null, 2)}`, 'success');
                    showResult('success', 'åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸ', 'GAS Web Appã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã—ãŸ');
                } else {
                    const text = await response.text();
                    log(`æ¥ç¶šå¤±æ•—: ${text}`, 'error');
                    showResult('error', 'åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆå¤±æ•—', `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
                }
                
            } catch (error) {
                log(`æ¥ç¶šã‚¨ãƒ©ãƒ¼: ${error.name} - ${error.message}`, 'error');
                showResult('error', 'åŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        // Test 2: ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆ
        async function testWithSimpleHeaders() {
            log('=== ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            try {
                const testUrl = `${NEW_GAS_URL}?action=test&timestamp=${Date.now()}`;
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'omit',
                    redirect: 'follow'
                    // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä¸€åˆ‡æŒ‡å®šã—ãªã„ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰
                });
                
                log(`ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status} ${response.statusText}`, 'info');
                
                if (response.ok) {
                    const result = await response.json();
                    log(`ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼æˆåŠŸ: ${JSON.stringify(result)}`, 'success');
                    showResult('success', 'ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆæˆåŠŸ', 'ãƒ˜ãƒƒãƒ€ãƒ¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹æˆåŠŸ');
                } else {
                    log(`ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼å¤±æ•—: ${response.status}`, 'error');
                    showResult('error', 'ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆå¤±æ•—', `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
                }
                
            } catch (error) {
                log(`ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'ã‚·ãƒ³ãƒ—ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        // Test 3: èªè¨¼ãƒ†ã‚¹ãƒˆ
        async function testAuthentication() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                showResult('error', 'å…¥åŠ›ã‚¨ãƒ©ãƒ¼', 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            log('=== èªè¨¼ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            log(`ãƒ¦ãƒ¼ã‚¶ãƒ¼å: ${username}`);
            
            try {
                const authUrl = `${NEW_GAS_URL}?action=authenticate&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&t=${Date.now()}`;
                log(`èªè¨¼URL: ${authUrl.substring(0, 100)}...`);
                
                const response = await fetch(authUrl, {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'omit',
                    redirect: 'follow'
                });
                
                log(`èªè¨¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status} ${response.statusText}`, 'info');
                
                if (response.ok) {
                    const result = await response.json();
                    log(`èªè¨¼çµæœ: ${JSON.stringify(result, null, 2)}`, 'success');
                    
                    if (result.success) {
                        showResult('success', 'èªè¨¼ãƒ†ã‚¹ãƒˆæˆåŠŸ', `ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ: ${result.message}`);
                    } else {
                        showResult('error', 'èªè¨¼å¤±æ•—', `ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—: ${result.message}`);
                    }
                } else {
                    const text = await response.text();
                    log(`èªè¨¼HTTPã‚¨ãƒ©ãƒ¼: ${text}`, 'error');
                    showResult('error', 'èªè¨¼ãƒ†ã‚¹ãƒˆå¤±æ•—', `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
                }
                
            } catch (error) {
                log(`èªè¨¼ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'èªè¨¼ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        // Test 4: æœ€å°ãƒ•ã‚§ãƒƒãƒ
        async function testMinimalFetch() {
            log('=== æœ€å°ãƒ•ã‚§ãƒƒãƒãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            try {
                const testUrl = `${NEW_GAS_URL}?action=test`;
                
                // æœ€å°é™ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³
                const response = await fetch(testUrl);
                
                log(`æœ€å°ãƒ•ã‚§ãƒƒãƒ ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status}`, 'info');
                
                if (response.ok) {
                    const result = await response.json();
                    log(`æœ€å°ãƒ•ã‚§ãƒƒãƒæˆåŠŸ: ${JSON.stringify(result)}`, 'success');
                    showResult('success', 'æœ€å°ãƒ•ã‚§ãƒƒãƒæˆåŠŸ', 'æœ€å°é™ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¢ã‚¯ã‚»ã‚¹æˆåŠŸ');
                } else {
                    showResult('error', 'æœ€å°ãƒ•ã‚§ãƒƒãƒå¤±æ•—', `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
                }
                
            } catch (error) {
                log(`æœ€å°ãƒ•ã‚§ãƒƒãƒã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'æœ€å°ãƒ•ã‚§ãƒƒãƒã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        // Test 5: æ¨™æº–ãƒ•ã‚§ãƒƒãƒ
        async function testStandardFetch() {
            log('=== æ¨™æº–ãƒ•ã‚§ãƒƒãƒãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            try {
                const testUrl = `${NEW_GAS_URL}?action=test&timestamp=${Date.now()}`;
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Cache-Control': 'no-cache'
                    },
                    mode: 'cors',
                    credentials: 'omit',
                    redirect: 'follow'
                });
                
                log(`æ¨™æº–ãƒ•ã‚§ãƒƒãƒ ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status}`, 'info');
                
                if (response.ok) {
                    const result = await response.json();
                    log(`æ¨™æº–ãƒ•ã‚§ãƒƒãƒæˆåŠŸ: ${JSON.stringify(result)}`, 'success');
                    showResult('success', 'æ¨™æº–ãƒ•ã‚§ãƒƒãƒæˆåŠŸ', 'æ¨™æº–çš„ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¢ã‚¯ã‚»ã‚¹æˆåŠŸ');
                } else {
                    showResult('error', 'æ¨™æº–ãƒ•ã‚§ãƒƒãƒå¤±æ•—', `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
                }
                
            } catch (error) {
                log(`æ¨™æº–ãƒ•ã‚§ãƒƒãƒã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'æ¨™æº–ãƒ•ã‚§ãƒƒãƒã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        // Test 6: CORSå›é¿ãƒ•ã‚§ãƒƒãƒ
        async function testCorsWorkaround() {
            log('=== CORSå›é¿ãƒ•ã‚§ãƒƒãƒãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            try {
                const testUrl = `${NEW_GAS_URL}?action=test&timestamp=${Date.now()}`;
                
                const response = await fetch(testUrl, {
                    method: 'GET',
                    mode: 'no-cors'  // CORSåˆ¶é™ã‚’å›é¿
                });
                
                log(`CORSå›é¿ ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status} (opaque response)`, 'info');
                log(`CORSå›é¿ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ—: ${response.type}`, 'info');
                
                // no-corsãƒ¢ãƒ¼ãƒ‰ã§ã¯å†…å®¹ã¯èª­ã‚ã¾ã›ã‚“ãŒã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€šã£ãŸã‹ã¯ç¢ºèªã§ãã¾ã™
                if (response.type === 'opaque') {
                    log(`CORSå›é¿æˆåŠŸ: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯é€ä¿¡ã•ã‚Œã¾ã—ãŸï¼ˆå†…å®¹ã¯èª­ã‚ã¾ã›ã‚“ï¼‰`, 'success');
                    showResult('success', 'CORSå›é¿æˆåŠŸ', 'no-corsãƒ¢ãƒ¼ãƒ‰ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡æˆåŠŸ');
                } else {
                    showResult('error', 'CORSå›é¿å¤±æ•—', 'äºˆæœŸã—ãªã„ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ—');
                }
                
            } catch (error) {
                log(`CORSå›é¿ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'CORSå›é¿ã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        // CORSè¨ºæ–­é–¢æ•°
        async function checkCorsHeaders() {
            log('=== CORSãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèªé–‹å§‹ ===');
            
            try {
                const response = await fetch(NEW_GAS_URL);
                
                log('CORSãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª:', 'info');
                const corsHeaders = [
                    'access-control-allow-origin',
                    'access-control-allow-methods',
                    'access-control-allow-headers',
                    'access-control-allow-credentials'
                ];
                
                corsHeaders.forEach(header => {
                    const value = response.headers.get(header);
                    log(`  ${header}: ${value || '(ãªã—)'}`, 'info');
                });
                
                showResult('info', 'CORSãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèªå®Œäº†', 'ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„');
                
            } catch (error) {
                log(`CORSãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèªã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'CORSãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèªã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        async function testPreflight() {
            log('=== Preflightãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            try {
                // Preflightã‚’ç™ºç”Ÿã•ã›ã‚‹ãŸã‚ã«ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨
                const response = await fetch(`${NEW_GAS_URL}?action=test`, {
                    method: 'GET',
                    headers: {
                        'X-Custom-Header': 'test'  // ã“ã‚Œã«ã‚ˆã‚ŠPreflight ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç™ºç”Ÿ
                    }
                });
                
                log(`Preflightå¾Œã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status}`, 'info');
                
                if (response.ok) {
                    const result = await response.json();
                    log(`Preflightãƒ†ã‚¹ãƒˆæˆåŠŸ: ${JSON.stringify(result)}`, 'success');
                    showResult('success', 'Preflightãƒ†ã‚¹ãƒˆæˆåŠŸ', 'ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ãã§ã‚¢ã‚¯ã‚»ã‚¹æˆåŠŸ');
                } else {
                    showResult('error', 'Preflightãƒ†ã‚¹ãƒˆå¤±æ•—', `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}`);
                }
                
            } catch (error) {
                log(`Preflightãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                showResult('error', 'Preflightãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼', error.message);
            }
        }

        async function testDifferentMethods() {
            log('=== ãƒ¡ã‚½ãƒƒãƒ‰æ¯”è¼ƒãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            const methods = ['GET', 'POST'];
            
            for (const method of methods) {
                try {
                    log(`${method} ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆä¸­...`, 'info');
                    
                    let options = { method: method };
                    
                    if (method === 'POST') {
                        options.headers = { 'Content-Type': 'application/json' };
                        options.body = JSON.stringify({ action: 'test' });
                    }
                    
                    const response = await fetch(`${NEW_GAS_URL}?action=test`, options);
                    
                    log(`${method} ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status}`, 'info');
                    
                    if (response.ok) {
                        log(`${method} ãƒ¡ã‚½ãƒƒãƒ‰æˆåŠŸ`, 'success');
                    } else {
                        log(`${method} ãƒ¡ã‚½ãƒƒãƒ‰å¤±æ•—: ${response.status}`, 'error');
                    }
                    
                } catch (error) {
                    log(`${method} ãƒ¡ã‚½ãƒƒãƒ‰ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                }
            }
            
            showResult('info', 'ãƒ¡ã‚½ãƒƒãƒ‰æ¯”è¼ƒãƒ†ã‚¹ãƒˆå®Œäº†', 'ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„');
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', function() {
            log('æ–°ã—ã„GAS URL ãƒ†ã‚¹ãƒˆé–‹å§‹');
            log(`å¯¾è±¡URL: ${NEW_GAS_URL}`);
            log('ã¾ãšã€ŒåŸºæœ¬æ¥ç¶šãƒ†ã‚¹ãƒˆã€ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„');
        });
    </script>
</body>
</html>
