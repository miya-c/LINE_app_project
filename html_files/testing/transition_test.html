<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>遷移テスト</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
        .url-info {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>property_select → room_select 遷移テスト</h1>
        
        <div class="url-info">
            <strong>現在のURL:</strong><br>
            <span id="currentUrl"></span>
        </div>
        
        <h2>テスト用リンク</h2>
        <p>property_selectから修正後の遷移をシミュレーション:</p>
        
        <button class="test-button" onclick="testTransition('P000001')">
            物件ID: P000001 で room_select に遷移
        </button>
        
        <button class="test-button" onclick="testTransition('P000002')">
            物件ID: P000002 で room_select に遷移
        </button>
        
        <button class="test-button" onclick="testTransitionNoParam()">
            パラメータなしで room_select に遷移（エラーテスト）
        </button>
        
        <button class="test-button" onclick="goToPropertySelect()">
            property_select.html に移動
        </button>
        
        <h2>URL詳細</h2>
        <div class="url-info" id="urlDetails"></div>
    </div>

    <script>
        // 現在のURL情報を表示
        function updateUrlInfo() {
            document.getElementById('currentUrl').textContent = window.location.href;
            
            const urlObj = new URL(window.location.href);
            const urlParams = new URLSearchParams(window.location.search);
            
            const details = {
                'プロトコル': urlObj.protocol,
                'ホスト': urlObj.host,
                'パス': urlObj.pathname,
                'クエリ文字列': urlObj.search,
                'パラメータ数': urlParams.size
            };
            
            let detailsHtml = '';
            Object.entries(details).forEach(([key, value]) => {
                detailsHtml += `<strong>${key}:</strong> ${value}<br>`;
            });
            
            // URLパラメータも表示
            if (urlParams.size > 0) {
                detailsHtml += '<br><strong>URLパラメータ:</strong><br>';
                for (const [key, value] of urlParams) {
                    detailsHtml += `  ${key}: ${value}<br>`;
                }
            }
            
            document.getElementById('urlDetails').innerHTML = detailsHtml;
        }
        
        // property_selectからの遷移をシミュレーション
        function testTransition(propertyId) {
            console.log(`テスト遷移: propertyId=${propertyId}`);
            
            // property_select.htmlで修正された形式でURLを生成
            const targetUrl = `/room_select?propertyId=${encodeURIComponent(propertyId)}`;
            console.log(`遷移先URL: ${targetUrl}`);
            
            // 実際の遷移（修正されたroom_select.htmlで処理される）
            window.location.href = targetUrl;
        }
        
        // パラメータなしでの遷移テスト（エラーケース）
        function testTransitionNoParam() {
            console.log('パラメータなしで遷移テスト');
            window.location.href = '/room_select';
        }
        
        // property_select.htmlに移動
        function goToPropertySelect() {
            window.location.href = '/property_select';
        }
        
        // ページ読み込み時に情報を更新
        window.onload = function() {
            updateUrlInfo();
            
            // URLが変更された際の情報更新（戻るボタンなど）
            window.addEventListener('popstate', updateUrlInfo);
        };
        
        console.log('遷移テストページが読み込まれました');
        console.log('現在のURL:', window.location.href);
    </script>
</body>
</html>
