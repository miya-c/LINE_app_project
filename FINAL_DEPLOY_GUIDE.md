# 🚀 Google Apps Script 水道検針システム - 最終デプロイガイド

## ⚡ 即座に使用開始する手順（3ステップ）

### 1️⃣ **トリガー設定**（初回のみ）
Google Apps Scriptエディタで実行：
```javascript
setupOnOpenTrigger()
```

### 2️⃣ **スプレッドシート準備**
1. Googleスプレッドシートを開く
2. **F5キー**でページを再読み込み
3. メニューバーに「**水道検針**」と「**総合カスタム処理**」が表示されることを確認

### 3️⃣ **アプリ起動**
スプレッドシートのメニューから：
**水道検針** → **アプリを開く**

---

## 🔧 トラブルシューティング

### ❌ メニューが表示されない場合
```javascript
// 診断実行
checkSystemHealth()

// 強制トリガー再設定
setupOnOpenTrigger()
```

### ❌ 実行コンテキストエラーが発生する場合
```javascript
// 実行環境テスト
testExecutionContext()
```

**解決策**: スプレッドシートのメニューから実行してください。スクリプトエディタからの直接実行はサポートされていません。

---

## 📊 必要なシート

| シート名（日本語優先） | 英語名（フォールバック） | 内容 |
|---|---|---|
| **物件マスタ** | property_master | 物件ID、物件名 |
| **部屋マスタ** | room_master | 物件ID、部屋ID、部屋名 |
| **inspection_data** | - | 検針データ（自動作成） |

---

## 🎯 機能概要

### 💧 水道検針システム
- 物件選択 → 部屋選択 → 検針データ入力
- リアルタイムデータ連携
- 日本語インターフェース

### ⚙️ 総合カスタム処理
- 物件IDフォーマット統一
- データ整合性チェック
- 自動データクリーンアップ

---

## ✅ デプロイ完了確認

実行して「✅」が表示されればOK：
```javascript
finalDeploymentCheck()
```

---

**🎉 準備完了！水道検針システムをお使いください！**
