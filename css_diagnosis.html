<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSSè¨ºæ–­ãƒ„ãƒ¼ãƒ« - æ°´é“ãƒ¡ãƒ¼ã‚¿ãƒ¼èª­ã¿å–ã‚Šã‚¢ãƒ—ãƒª</title>
    <style>
        /* è¨ºæ–­ãƒ„ãƒ¼ãƒ«å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .diagnosis-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #fafafa;
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        .result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        
        .test-element {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
    
    <!-- ã‚¢ãƒ—ãƒªã®CSSèª­ã¿è¾¼ã¿ -->
    <link rel="stylesheet" href="css_styles/property_select.css?v=20250615">
    <link rel="stylesheet" href="css_styles/pwa-styles.css?v=20250615">
</head>
<body>
    <div class="diagnosis-container">
        <h1>ğŸ”§ CSSå‹•ä½œè¨ºæ–­ãƒ„ãƒ¼ãƒ«</h1>
        <p>æ°´é“ãƒ¡ãƒ¼ã‚¿ãƒ¼èª­ã¿å–ã‚Šã‚¢ãƒ—ãƒªã®CSSè¨­å®šã¨å‹•ä½œçŠ¶æ³ã‚’è¨ºæ–­ã—ã¾ã™ã€‚</p>

        <!-- 1. CSSèª­ã¿è¾¼ã¿çŠ¶æ³ -->
        <div class="test-section">
            <div class="test-title">ğŸ“ 1. CSSãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿çŠ¶æ³</div>
            <div id="css-load-status">ãƒ†ã‚¹ãƒˆä¸­...</div>
        </div>

        <!-- 2. CSSå¤‰æ•°å®šç¾©ç¢ºèª -->
        <div class="test-section">
            <div class="test-title">ğŸ¨ 2. CSSå¤‰æ•°å®šç¾©ç¢ºèª</div>
            <div id="css-variables-status">ãƒ†ã‚¹ãƒˆä¸­...</div>
        </div>

        <!-- 3. ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ãƒ†ã‚¹ãƒˆ -->
        <div class="test-section">
            <div class="test-title">âœ¨ 3. ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ãƒ†ã‚¹ãƒˆ</div>
            <div id="style-test-status">ãƒ†ã‚¹ãƒˆä¸­...</div>
            
            <!-- ãƒ†ã‚¹ãƒˆç”¨è¦ç´  -->
            <div class="test-element">
                <h3>ãƒ†ã‚¹ãƒˆç”¨Mantineã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</h3>
                <div class="mantine-container">
                    <div class="mantine-stack">
                        <h2 class="mantine-title">ã‚¿ã‚¤ãƒˆãƒ«ãƒ†ã‚¹ãƒˆ</h2>
                        <div class="mantine-text-input">
                            <input type="text" placeholder="å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ" />
                        </div>
                        <button class="mantine-button variant-filled">ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ</button>
                        <div class="mantine-paper">
                            <div class="property-card">
                                <div class="property-info">
                                    <div class="property-id">P000001</div>
                                    <div class="property-name">ãƒ†ã‚¹ãƒˆç‰©ä»¶</div>
                                </div>
                                <div class="property-arrow">â†’</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. FOUCå¯¾ç­–ç¢ºèª -->
        <div class="test-section">
            <div class="test-title">âš¡ 4. FOUCå¯¾ç­–ãƒ»CSSèª­ã¿è¾¼ã¿å¾…æ©Ÿæ©Ÿèƒ½</div>
            <div id="fouc-test-status">ãƒ†ã‚¹ãƒˆä¸­...</div>
        </div>

        <!-- 5. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œç¢ºèª -->
        <div class="test-section">
            <div class="test-title">ğŸ“± 5. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œç¢ºèª</div>
            <div id="responsive-test-status">ãƒ†ã‚¹ãƒˆä¸­...</div>
        </div>

        <!-- è¨ºæ–­çµæœã‚µãƒãƒªãƒ¼ -->
        <div class="test-section">
            <div class="test-title">ğŸ“Š è¨ºæ–­çµæœã‚µãƒãƒªãƒ¼</div>
            <div id="summary-status">é›†è¨ˆä¸­...</div>
        </div>
    </div>

    <script>
        // è¨ºæ–­å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”§ CSSè¨ºæ–­ãƒ„ãƒ¼ãƒ«é–‹å§‹');
            
            let results = [];
            
            // 1. CSSèª­ã¿è¾¼ã¿çŠ¶æ³ãƒ†ã‚¹ãƒˆ
            function checkCSSLoad() {
                const statusDiv = document.getElementById('css-load-status');
                const results = [];
                
                // StyleSheetã®ç¢ºèª
                const stylesheets = Array.from(document.styleSheets);
                const appStylesheets = stylesheets.filter(sheet => 
                    sheet.href && (sheet.href.includes('property_select.css') || sheet.href.includes('pwa-styles.css'))
                );
                
                results.push(`
                    <div class="result ${appStylesheets.length >= 2 ? 'success' : 'error'}">
                        ${appStylesheets.length >= 2 ? 'âœ…' : 'âŒ'} ã‚¢ãƒ—ãƒªCSSãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿: ${appStylesheets.length}/2 ãƒ•ã‚¡ã‚¤ãƒ«
                    </div>
                `);
                
                // å„CSSãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°ç¢ºèª
                appStylesheets.forEach(sheet => {
                    try {
                        const rulesCount = sheet.cssRules ? sheet.cssRules.length : 0;
                        results.push(`
                            <div class="result ${rulesCount > 0 ? 'success' : 'warning'}">
                                ğŸ“„ ${sheet.href.split('/').pop()}: ${rulesCount} ãƒ«ãƒ¼ãƒ«
                            </div>
                        `);
                    } catch (e) {
                        results.push(`
                            <div class="result warning">
                                âš ï¸ ${sheet.href.split('/').pop()}: CORSåˆ¶é™ã«ã‚ˆã‚Šãƒ«ãƒ¼ãƒ«æ•°ç¢ºèªä¸å¯
                            </div>
                        `);
                    }
                });
                
                statusDiv.innerHTML = results.join('');
                return appStylesheets.length >= 2;
            }
            
            // 2. CSSå¤‰æ•°ç¢ºèª
            function checkCSSVariables() {
                const statusDiv = document.getElementById('css-variables-status');
                const rootStyle = window.getComputedStyle(document.documentElement);
                
                const variables = [
                    '--mantine-color-blue-6',
                    '--mantine-color-gray-0',
                    '--mantine-color-gray-7',
                    '--mantine-spacing-md',
                    '--mantine-radius-sm'
                ];
                
                const results = variables.map(varName => {
                    const value = rootStyle.getPropertyValue(varName).trim();
                    return `
                        <div class="result ${value ? 'success' : 'error'}">
                            ${value ? 'âœ…' : 'âŒ'} ${varName}: ${value || 'æœªå®šç¾©'}
                        </div>
                    `;
                });
                
                statusDiv.innerHTML = results.join('');
                return variables.every(varName => rootStyle.getPropertyValue(varName).trim());
            }
            
            // 3. ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ãƒ†ã‚¹ãƒˆ
            function checkStyleApplication() {
                const statusDiv = document.getElementById('style-test-status');
                const results = [];
                
                // ãƒ†ã‚¹ãƒˆç”¨è¦ç´ ã‚’ä½œæˆ
                const testElements = [
                    { className: 'mantine-button', expectedProps: ['display', 'padding', 'borderRadius'] },
                    { className: 'mantine-container', expectedProps: ['maxWidth', 'margin'] },
                    { className: 'mantine-title', expectedProps: ['fontSize', 'fontWeight'] },
                    { className: 'mantine-paper', expectedProps: ['backgroundColor', 'border', 'padding'] }
                ];
                
                testElements.forEach(({ className, expectedProps }) => {
                    const testEl = document.createElement('div');
                    testEl.className = className;
                    document.body.appendChild(testEl);
                    
                    const computed = getComputedStyle(testEl);
                    const appliedProps = expectedProps.filter(prop => {
                        const value = computed[prop];
                        return value && value !== 'auto' && value !== 'normal' && value !== '0px';
                    });
                    
                    const success = appliedProps.length > 0;
                    results.push(`
                        <div class="result ${success ? 'success' : 'error'}">
                            ${success ? 'âœ…' : 'âŒ'} .${className} 
                            (é©ç”¨æ¸ˆã¿: ${appliedProps.length}/${expectedProps.length} ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£)
                            ${success ? '' : `<br><small>æœŸå¾…å€¤: ${expectedProps.join(', ')}</small>`}
                        </div>
                    `);
                    
                    document.body.removeChild(testEl);
                });
                
                statusDiv.innerHTML = results.join('');
                return testElements.length > 0;
            }
            
            // 4. FOUCå¯¾ç­–ç¢ºèª
            function checkFOUCPrevention() {
                const statusDiv = document.getElementById('fouc-test-status');
                const results = [];
                
                // styles-loading/styles-loadedã‚¯ãƒ©ã‚¹ã®å­˜åœ¨ç¢ºèª
                const hasLoadingClass = document.querySelector('.styles-loading, .styles-loaded');
                results.push(`
                    <div class="result ${hasLoadingClass ? 'success' : 'warning'}">
                        ${hasLoadingClass ? 'âœ…' : 'âš ï¸'} FOUCå¯¾ç­–ã‚¯ãƒ©ã‚¹: ${hasLoadingClass ? 'å®Ÿè£…æ¸ˆã¿' : 'æœªå®Ÿè£…'}
                    </div>
                `);
                
                // waitForStylesLoadedé–¢æ•°ã®å­˜åœ¨ç¢ºèª
                const hasWaitFunction = typeof window.waitForStylesLoaded === 'function';
                results.push(`
                    <div class="result ${hasWaitFunction ? 'success' : 'info'}">
                        ${hasWaitFunction ? 'âœ…' : 'â„¹ï¸'} CSSèª­ã¿è¾¼ã¿å¾…æ©Ÿæ©Ÿèƒ½: ${hasWaitFunction ? 'å®Ÿè£…æ¸ˆã¿' : 'ç¢ºèªã§ãã¾ã›ã‚“'}
                    </div>
                `);
                
                statusDiv.innerHTML = results.join('');
                return true;
            }
            
            // 5. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œç¢ºèª
            function checkResponsiveDesign() {
                const statusDiv = document.getElementById('responsive-test-status');
                const results = [];
                
                // ãƒ¡ãƒ‡ã‚£ã‚¢ã‚¯ã‚¨ãƒªã®ç¢ºèª
                const mediaQueries = [];
                try {
                    Array.from(document.styleSheets).forEach(sheet => {
                        if (sheet.cssRules) {
                            Array.from(sheet.cssRules).forEach(rule => {
                                if (rule.type === CSSRule.MEDIA_RULE && rule.media.mediaText.includes('768px')) {
                                    mediaQueries.push(rule.media.mediaText);
                                }
                            });
                        }
                    });
                } catch (e) {
                    // CORSåˆ¶é™ã®å ´åˆ
                }
                
                results.push(`
                    <div class="result ${mediaQueries.length > 0 ? 'success' : 'warning'}">
                        ${mediaQueries.length > 0 ? 'âœ…' : 'âš ï¸'} ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œãƒ¡ãƒ‡ã‚£ã‚¢ã‚¯ã‚¨ãƒª: ${mediaQueries.length > 0 ? 'å®Ÿè£…æ¸ˆã¿' : 'ç¢ºèªã§ãã¾ã›ã‚“'}
                    </div>
                `);
                
                // ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆè¨­å®šç¢ºèª
                const viewport = document.querySelector('meta[name="viewport"]');
                results.push(`
                    <div class="result ${viewport ? 'success' : 'error'}">
                        ${viewport ? 'âœ…' : 'âŒ'} ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆè¨­å®š: ${viewport ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š'}
                    </div>
                `);
                
                statusDiv.innerHTML = results.join('');
                return true;
            }
            
            // å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            const testResults = [
                checkCSSLoad(),
                checkCSSVariables(),
                checkStyleApplication(),
                checkFOUCPrevention(),
                checkResponsiveDesign()
            ];
            
            // ã‚µãƒãƒªãƒ¼è¡¨ç¤º
            function showSummary() {
                const summaryDiv = document.getElementById('summary-status');
                const passedTests = testResults.filter(Boolean).length;
                const totalTests = testResults.length;
                
                const overallStatus = passedTests === totalTests ? 'success' : 
                                     passedTests >= totalTests * 0.7 ? 'warning' : 'error';
                
                summaryDiv.innerHTML = `
                    <div class="result ${overallStatus}">
                        <h3>${passedTests === totalTests ? 'ğŸ‰' : passedTests >= totalTests * 0.7 ? 'âš ï¸' : 'âŒ'} 
                        ç·åˆçµæœ: ${passedTests}/${totalTests} ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹</h3>
                        <p>CSSè¨­å®šçŠ¶æ³: ${
                            passedTests === totalTests ? 'å„ªç§€ - ã™ã¹ã¦æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™' :
                            passedTests >= totalTests * 0.7 ? 'è‰¯å¥½ - ä¸€éƒ¨æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™' :
                            'è¦æ”¹å–„ - è¤‡æ•°ã®å•é¡ŒãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ'
                        }</p>
                    </div>
                `;
            }
            
            // å°‘ã—é…å»¶ã•ã›ã¦ã‚µãƒãƒªãƒ¼è¡¨ç¤º
            setTimeout(showSummary, 500);
            
            console.log('ğŸ”§ CSSè¨ºæ–­å®Œäº†');
        });
    </script>
</body>
</html>
