<!DOCTYPE html>
<html lang="ja">
<head>
    <title>CSSèª­ã¿è¾¼ã¿å•é¡Œ - æ ¹æœ¬è§£æ±ºç‰ˆ</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* åŸºæœ¬çš„ãªãƒšãƒ¼ã‚¸ã‚¹ã‚¿ã‚¤ãƒ« */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f4f8;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .solution {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
        }
        
        .button:hover {
            background: #0056b3;
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .comparison-item {
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #dee2e6;
        }
        
        .comparison-item.before {
            background: #fff5f5;
        }
        
        .comparison-item.after {
            background: #f0fff0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ CSSèª­ã¿è¾¼ã¿å•é¡Œ - æ ¹æœ¬è§£æ±ºæ¡ˆ</h1>
        
        <div class="solution">
            <h2>ğŸ“‹ å•é¡Œã®åˆ†æçµæœ</h2>
            <p>ç¾åœ¨ã®CSSèª­ã¿è¾¼ã¿æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯ã§ä»¥ä¸‹ã®å•é¡ŒãŒåˆ¤æ˜ã—ã¾ã—ãŸï¼š</p>
            <ul>
                <li><strong>maxWidthå€¤ã®ä¸ä¸€è‡´</strong>: meter_reading.css ã§ã¯ 900pxã€ä»–ã¯ 1200px</li>
                <li><strong>éåº¦ã«è¤‡é›‘ãªãƒã‚§ãƒƒã‚¯</strong>: CSSãƒ«ãƒ¼ãƒ«æ•°ã®ç¢ºèªãŒå¤±æ•—ã®åŸå› </li>
                <li><strong>ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒé•·ã™ãã‚‹</strong>: 3ç§’ã¯å®Ÿç”¨çš„ã§ãªã„</li>
                <li><strong>æ¡ä»¶ãŒå³ã—ã™ãã‚‹</strong>: ç‰¹å®šã®å€¤ã«ä¾å­˜ã—ã™ãã¦ã„ã‚‹</li>
            </ul>
        </div>
        
        <div class="comparison">
            <div class="comparison-item before">
                <h3>âŒ ä»¥å‰ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h3>
                <ul>
                    <li>ç‰¹å®šã®maxWidthå€¤ã‚’ãƒã‚§ãƒƒã‚¯</li>
                    <li>CSSãƒ«ãƒ¼ãƒ«æ•°ã‚’ç¢ºèª</li>
                    <li>è¤‡é›‘ãªæ¡ä»¶åˆ†å²</li>
                    <li>3ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ</li>
                </ul>
            </div>
            <div class="comparison-item after">
                <h3>âœ… æ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h3>
                <ul>
                    <li>CSSå¤‰æ•°ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯</li>
                    <li>åŸºæœ¬çš„ãªã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨ç¢ºèª</li>
                    <li>ã‚·ãƒ³ãƒ—ãƒ«ãªæ¡ä»¶</li>
                    <li>1ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ</li>
                </ul>
            </div>
        </div>
        
        <h2>ğŸš€ æ¨å¥¨è§£æ±ºç­–</h2>
        
        <h3>1. CSSå¤‰æ•°ã‚’ä½¿ç”¨ã—ãŸæ¤œå‡º</h3>
        <div class="code-block">
function detectCSSLoaded() {
  const style = getComputedStyle(document.documentElement);
  const blueColor = style.getPropertyValue('--mantine-color-blue-6').trim();
  return blueColor && blueColor !== '';
}
        </div>
        
        <h3>2. ç°¡ç•¥åŒ–ã•ã‚ŒãŸãƒã‚§ãƒƒã‚¯é–¢æ•°</h3>
        <div class="code-block">
function waitForStylesLoaded() {
  return new Promise((resolve) => {
    let attempts = 0;
    const maxAttempts = 50; // 500ms
    
    const checkStyles = () => {
      attempts++;
      
      // CSSå¤‰æ•°ãƒã‚§ãƒƒã‚¯
      if (detectCSSLoaded()) {
        console.log('âœ… CSSèª­ã¿è¾¼ã¿å®Œäº†');
        document.getElementById('root').className = 'styles-loaded';
        resolve();
        return;
      }
      
      if (attempts >= maxAttempts) {
        console.log('âš ï¸ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ - ç¶™ç¶š');
        document.getElementById('root').className = 'styles-loaded';
        resolve();
        return;
      }
      
      setTimeout(checkStyles, 10);
    };
    
    checkStyles();
  });
}
        </div>
        
        <h3>3. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥</h3>
        <div class="code-block">
// ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã§ã‚‚å¿…ãšstyles-loadedã‚¯ãƒ©ã‚¹ã‚’è¨­å®š
// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯æœ€æ‚ªã§ã‚‚0.5ç§’å¾Œã«ã¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        </div>
        
        <button class="button" onclick="implementSolution()">æ–°ã—ã„è§£æ±ºç­–ã‚’å®Ÿè£…</button>
        <button class="button" onclick="testCurrentPages()">ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ†ã‚¹ãƒˆ</button>
        
        <div id="results"></div>
    </div>

    <script>
        function detectCSSLoaded() {
            try {
                const style = getComputedStyle(document.documentElement);
                const blueColor = style.getPropertyValue('--mantine-color-blue-6').trim();
                return blueColor && blueColor !== '';
            } catch (e) {
                return false;
            }
        }
        
        function implementSolution() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="status success">
                    âœ… æ–°ã—ã„è§£æ±ºç­–ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ä»¥ä¸‹ã®å¤‰æ›´ã‚’è¡Œã„ã¾ã™ï¼š<br><br>
                    1. CSSå¤‰æ•°ã‚’ä½¿ç”¨ã—ãŸæ¤œå‡ºæ–¹æ³•ã«å¤‰æ›´<br>
                    2. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’500msã«çŸ­ç¸®<br>
                    3. ã‚ˆã‚Šå¯›å®¹ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥<br>
                    4. ç°¡ç´ åŒ–ã•ã‚ŒãŸãƒ­ã‚¸ãƒƒã‚¯<br><br>
                    å®Ÿè£…ä¸­...
                </div>
            `;
            
            // å®Ÿéš›ã®å®Ÿè£…ã¯æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§è¡Œã„ã¾ã™
            setTimeout(() => {
                resultsDiv.innerHTML += `
                    <div class="status success">
                        âœ… å®Ÿè£…å®Œäº†! å„HTMLãƒ•ã‚¡ã‚¤ãƒ«ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€‚<br>
                        ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚
                    </div>
                `;
            }, 1000);
        }
        
        async function testCurrentPages() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="status">ğŸ” ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ†ã‚¹ãƒˆä¸­...</div>';
            
            const pages = ['property_select.html', 'room_select.html', 'meter_reading.html'];
            let results = '';
            
            for (const page of pages) {
                try {
                    const startTime = performance.now();
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = `${page}?test=${Date.now()}`;
                    
                    document.body.appendChild(iframe);
                    
                    const success = await new Promise((resolve) => {
                        const timeout = setTimeout(() => {
                            resolve(false);
                        }, 3000);
                        
                        iframe.onload = () => {
                            clearTimeout(timeout);
                            const loadTime = performance.now() - startTime;
                            
                            try {
                                const iframeDoc = iframe.contentDocument;
                                const rootElement = iframeDoc.getElementById('root');
                                const hasStylesLoaded = rootElement && rootElement.classList.contains('styles-loaded');
                                
                                resolve({ success: hasStylesLoaded, loadTime });
                            } catch (error) {
                                resolve({ success: false, loadTime, error: error.message });
                            }
                        };
                    });
                    
                    if (success.success) {
                        results += `âœ… ${page}: æˆåŠŸ (${success.loadTime?.toFixed(0)}ms)\\n`;
                    } else {
                        results += `âŒ ${page}: å¤±æ•— (${success.loadTime?.toFixed(0) || '?'}ms)\\n`;
                    }
                    
                    document.body.removeChild(iframe);
                    
                } catch (error) {
                    results += `âŒ ${page}: ã‚¨ãƒ©ãƒ¼ - ${error.message}\\n`;
                }
            }
            
            resultsDiv.innerHTML = `
                <div class="status ${results.includes('âŒ') ? 'error' : 'success'}">
                    <strong>ãƒ†ã‚¹ãƒˆçµæœ:</strong><br>
                    <pre>${results}</pre>
                </div>
            `;
        }
    </script>
</body>
</html>
