# 総合カスタム処理メニュー 説明書

この説明書は、Googleスプレッドシートで「総合カスタム処理」メニューを使う方のためのガイドです。プログラミングの知識がなくても、誰でも簡単に使えるようにまとめています。

---

## 1. メニューの表示方法

1. Googleスプレッドシートを開きます。
2. 上部メニューバーに「**総合カスタム処理**」という新しいメニューが自動で表示されます。
   - もし表示されない場合は、シートを再読み込み（F5）してください。
   - それでも表示されない場合は、スクリプトエディタで `forceCreateMenu` 関数を実行してください。

---

## 2. メニューの各機能と使い方

### 1. 物件マスタの物件IDフォーマット

- **目的**：物件マスタの「物件ID」を「P+6桁の数字」（例：P000123）の形式に自動で統一します。
- **使い方**：
　「総合カスタム処理」→「1. 物件マスタの物件IDフォーマット」をクリック

---

### 2. 部屋マスタの物件IDフォーマット

- **目的**：部屋マスタの「物件ID」も「P+6桁の数字」形式に自動で統一します。
- **使い方**：
　「総合カスタム処理」→「2. 部屋マスタの物件IDフォーマット」をクリック

---

### 3. 部屋マスタの孤立データ削除

- **目的**：物件マスタに存在しない物件IDが部屋マスタにあれば、その部屋データを自動で削除します。
- **使い方**：
　「総合カスタム処理」→「3. 部屋マスタの孤立データ削除」をクリック

---

### 4. 初期検針データ作成

- **目的**：部屋マスタに登録されている全ての部屋について、検針データ（inspection_data）シートに初期データを自動で作成します。
- **使い方**：
　「総合カスタム処理」→「4. 初期検針データ作成」をクリック

---

### 5. マスタから検針データへ新規部屋反映

- **目的**：部屋マスタに新しく追加された部屋があれば、検針データシートに自動で追加します。
- **使い方**：
　「総合カスタム処理」→「5. マスタから検針データへ新規部屋反映」をクリック

---

### 6. 月次検針データ保存とリセット

- **目的**：検針データ（inspection_data）を「○年○月」シートにコピーして保存し、検針数値をリセットします。
- **使い方**：
　「総合カスタム処理」→「6. 月次検針データ保存とリセット」をクリック

---

## 3. よくある質問

**Q. メニューが表示されない場合は？**  
A. シートを再読み込み（F5）してください。それでも表示されない場合は、スクリプトエディタで`forceCreateMenu`関数を実行してください。

**Q. エラーが出た場合は？**  
A. 画面にエラーメッセージが表示されます。内容を確認し、必要に応じて管理者にご相談ください。

**Q. どのシートが対象ですか？**  
A.  

- 物件マスタ：物件情報を管理するシート
- 部屋マスタ：部屋情報を管理するシート
- inspection_data：検針データを管理するシート

---

## 4. 注意事項

- これらの機能は**元に戻せません**。実行前に必要に応じてシートのバックアップを取ってください。
- メニュー操作は**1クリックで自動処理**されます。完了メッセージが出るまでお待ちください。

---

## 5. サポート

分からないことがあれば、管理者またはシステム担当者にご相談ください。

---

**この説明書は印刷して現場に置いておくと便利です。**
